<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>SHUD</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link rel="icon" href="/favicon.ico" type="image/png" />

    <style>
      .panel-cs2 {
        background: rgba(20, 20, 20, 0.85);
        backdrop-filter: blur(8px);
        border-radius: 12px;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.05);
      }
      .button-cs2 {
        background: linear-gradient(90deg, #ffd600 0%, #ffea00 100%);
        color: #222;
        font-weight: bold;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        transition: box-shadow 0.2s, background 0.2s;
      }
      .button-cs2:hover {
        box-shadow: 0 4px 16px #ffd60088;
        background: linear-gradient(90deg, #ffea00 0%, #ffd600 100%);
      }
      #maps-save-btn {
        display: none !important;
      }
      .file-name-note {
        margin-top: 6px;
        font-size: 12px;
        color: #ddd;
        word-break: break-all;
      }
    </style>

    <script>
      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—É—Ç–µ–π –∫ –∞–≤–∞—Ç–∞—Ä–∫–∞–º
      function fixAvatarPaths() {
        // –ò—â–µ–º –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –∞–≤–∞—Ç–∞—Ä–∫–∞–º–∏ –∏–≥—Ä–æ–∫–æ–≤
        const avatarImages = document.querySelectorAll(
          ".player-avatar img, .avatar-image"
        );

        avatarImages.forEach((img) => {
          if (
            img.src &&
            !img.src.includes("/uploads/") &&
            !img.src.includes("default-avatar.png")
          ) {
            // –ü–æ–ª—É—á–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ –ø—É—Ç–∏
            const filename = img.src.split("/").pop();

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π –ø—É—Ç—å —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º /uploads/
            img.src = `/uploads/${filename}`;
            console.log("Fixed avatar path:", img.src);
          }
        });
      }

      // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      document.addEventListener("DOMContentLoaded", function () {
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        fixAvatarPaths();

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        setTimeout(fixAvatarPaths, 1000);

        // –ó–∞–ø—É—Å–∫–∞–µ–º –µ—â–µ —Ä–∞–∑ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
        setTimeout(fixAvatarPaths, 3000);
      });
    </script>
  </head>
  <body>
    <div class="app-container">
      <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
      <nav class="sidebar">
        <div class="sidebar">
          <div class="logo">
            <img src="/images/logo.png" alt="SHUD Manager" />
            <h1 data-i18n="appTitle">SHUD Manager</h1>
            <span
              class="region-flag app-flag"
              onclick="changeLanguage('ru')"
              title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫"
              >üá∑üá∫</span
            >
          </div>
          <ul class="nav-menu">
            <li class="nav-item">
              <button class="nav-button" data-section="match-section">
                <i class="fas fa-gamepad"></i>
                <span data-i18n="navCreateMatch">–°–æ–∑–¥–∞—Ç—å –ú–∞—Ç—á</span>
              </button>
            </li>
            <li class="nav-item">
              <button class="nav-button" data-section="teams-section">
                <i class="fas fa-users"></i>
                <span data-i18n="navCreateTeam">–°–æ–∑–¥–∞—Ç—å –ö–æ–º–∞–Ω–¥—É</span>
              </button>
            </li>
            <li class="nav-item">
              <button class="nav-button" data-section="players-section">
                <i class="fas fa-user"></i>
                <span data-i18n="navCreatePlayer">–°–æ–∑–¥–∞—Ç—å –ò–≥—Ä–æ–∫–∞</span>
              </button>
            </li>
            <li class="nav-item">
              <button class="nav-button" data-section="scoreboard-section">
                <i class="fas fa-table"></i>
                <span data-i18n="navScoreboard">–°–∫–æ—Ä–±–æ—Ä–¥</span>
              </button>
            </li>
            <li class="nav-item">
              <button class="nav-button" data-section="huds-section">
                <i class="fas fa-desktop"></i>
                <span data-i18n="navHuds">HUD'—ã</span>
              </button>
            </li>
            <li class="nav-item">
              <button class="nav-button active" data-section="cs2-section">
                <i class="fas fa-gamepad"></i>
                <span data-i18n="navCS2Integration">CFG –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</span>
              </button>
            </li>
            <li class="nav-item">
              <button class="nav-button active" data-section="cameras-section">
                <i class="fas fa-camera"></i>
                <span data-i18n="navCS2Cameras">–ö–∞–º–µ—Ä—ã BETA</span>
              </button>
            </li>
            <li class="nav-item">
              <button class="nav-button" data-section="hide-players-section">
                <i class="fas fa-user-slash"></i>
                <span>–°–∫—Ä—ã—Ç–∏–µ –¢—Ä–µ–Ω–µ—Ä–∞</span>
              </button>
            </li>
          </ul>
        </div>
        <div class="language-selector-container">
          <div>
            <label for="language-selector" data-i18n="languageSelector"
              >language:</label
            >
          </div>
          <select id="language-selector" class="form-control">
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="en">English</option>
            <option value="zh">‰∏≠Êñá</option>
          </select>
        </div>

        <div class="social-links-container">
          <a
            href="https://discord.gg/7BtSdAmTf8"
            target="_blank"
            class="social-link discord"
            title="Discord"
          >
            <i class="fab fa-discord"></i>
          </a>
          <a
            href="https://www.twitch.tv/fyflo"
            target="_blank"
            class="social-link twitch"
            title="Twitch"
          >
            <i class="fab fa-twitch"></i>
          </a>
          <a
            href="https://kick.com/fyflo"
            target="_blank"
            class="social-link kick"
            title="Kick"
          >
            <i class="fas fa-play"></i>
          </a>
          <a
            href="https://t.me/CS_fyflo_stream"
            target="_blank"
            class="social-link telegram"
            title="Telegram"
          >
            <i class="fab fa-telegram"></i>
          </a>
          <a
            href="https://donatepay.ru/p/fyflo"
            target="_blank"
            class="social-link donate"
            title="–ù–∞ —á–∞–π"
          >
            <i class="fas fa-coffee"></i>
          </a>
        </div>
      </nav>

      <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
      <main class="main-content">
        <!-- –§–æ—Ä–º–∞ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∏–≥—Ä–æ–∫–æ–≤ –ø–æ Steam64 ID -->
        <section id="hide-players-section" class="content-section panel-cs2">
          <h3>–°–∫—Ä—ã—Ç—å –¢—Ä–µ–Ω–µ—Ä–∞ –ø–æ Steam64 ID</h3>
          <form id="hidePlayersForm">
            <div class="form-group">
              <label for="steamid1">Steam64 ID 1:</label>
              <input
                type="text"
                id="steamid1"
                name="steamid1"
                maxlength="20"
                style="width: 100%"
                placeholder="7656..."
              />
            </div>
            <div class="form-group">
              <label for="steamid2">Steam64 ID 2:</label>
              <input
                type="text"
                id="steamid2"
                name="steamid2"
                maxlength="20"
                style="width: 100%"
                placeholder="7656..."
              />
            </div>
          </form>
          <button
            id="sendHidePlayersToHUD"
            class="button-cs2"
            style="margin-top: 10px; width: 100%"
          >
            –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∫—Ä—ã—Ç–∏–µ –¢—Ä–µ–Ω–µ—Ä–∞ –≤ HUD
          </button>
          <div id="spec-binds-block" style="margin-top: 12px">
            <h4>
              –ë–∏–Ω–¥—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–≥—Ä–æ–∫–æ–≤ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–Ω–¥–∞: exec
              observer_spec_binds | —Å–±—Ä–æ—Å –±–∏–Ω–¥–æ–≤: exec default.cfg)
            </h4>
            <div style="display: flex; gap: 8px; margin-bottom: 8px">
              <button id="refresh-binds" class="button-cs2">
                –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
              </button>
              <button id="copy-binds" class="button-cs2">
                –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ
              </button>
            </div>
            <textarea
              id="binds-output"
              readonly
              rows="10"
              style="width: 100%; font-family: monospace"
            ></textarea>
            <div class="file-name-note">
              –°–ª–æ—Ç—ã: 1‚Äì9, 0, -, = –ø–æ observer_slot 0‚Äì11. –ò—Å–∫–ª—é—á–∞—é—Ç—Å—è Steam64 –∏–∑
              –ø–æ–ª–µ–π –≤—ã—à–µ.
            </div>
          </div>
        </section>

        <script>
          // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
          document.addEventListener("DOMContentLoaded", function () {
            document.getElementById("steamid1").value =
              localStorage.getItem("hiddenSteamId1") || "";
            document.getElementById("steamid2").value =
              localStorage.getItem("hiddenSteamId2") || "";

            // –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–∫—Ä—ã—Ç–∏—è –∏–≥—Ä–æ–∫–æ–≤ –≤ HUD
            const sendBtn = document.getElementById("sendHidePlayersToHUD");
            if (sendBtn) {
              sendBtn.addEventListener("click", function () {
                const steamid1 = document
                  .getElementById("steamid1")
                  .value.trim();
                const steamid2 = document
                  .getElementById("steamid2")
                  .value.trim();

                // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –≤ localStorage
                localStorage.setItem("hiddenSteamId1", steamid1);
                localStorage.setItem("hiddenSteamId2", steamid2);

                if (
                  window.gsiManager &&
                  typeof window.gsiManager.sendToHUD === "function"
                ) {
                  window.gsiManager.sendToHUD({
                    type: "hide_players",
                    steamids: [steamid1, steamid2],
                  });
                  alert("–°–∫—Ä—ã—Ç–∏–µ –∏–≥—Ä–æ–∫–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ HUD!");
                } else {
                  alert("–û—à–∏–±–∫–∞: GSIManager –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω!");
                }
              });
            }

            // ===== –ë–ª–æ–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–∏–Ω–¥–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–≥—Ä–æ–∫–æ–≤ =====
            const bindsOutput = document.getElementById("binds-output");
            const refreshBindsBtn = document.getElementById("refresh-binds");
            const copyBindsBtn = document.getElementById("copy-binds");

            function mapSlotToKey(slot) {
              const n = Number(slot);
              if (!Number.isFinite(n)) return null;
              if (n >= 0 && n <= 8) return String(n + 1);
              if (n === 9) return "0";
              if (n === 10) return "-";
              if (n === 11) return "=";
              return null;
            }

            function escapeQuotes(s) {
              return String(s || "").replace(/"/g, '\\"');
            }

            function sortPlayers(players) {
              const orderTeam = (t) => (t === "CT" ? 0 : t === "T" ? 1 : 2);
              return players.slice().sort((a, b) => {
                const ta = orderTeam(a.team);
                const tb = orderTeam(b.team);
                if (ta !== tb) return ta - tb;
                const sa = a.observer_slot ?? 999;
                const sb = b.observer_slot ?? 999;
                return sa - sb;
              });
            }

            async function fetchPlayers() {
              try {
                const resp = await fetch("/api/cs2/players");
                if (!resp.ok) throw new Error("HTTP " + resp.status);
                const data = await resp.json();
                return Array.isArray(data?.players) ? data.players : [];
              } catch (e) {
                console.error("Failed to fetch players:", e);
                return [];
              }
            }

            async function renderSpecBinds() {
              if (!bindsOutput) return;
              bindsOutput.value = "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤...";

              const players = await fetchPlayers();
              const s1 = (
                document.getElementById("steamid1").value || ""
              ).trim();
              const s2 = (
                document.getElementById("steamid2").value || ""
              ).trim();
              const excluded = new Set([s1, s2].filter(Boolean));

              const filtered = players.filter(
                (p) => !excluded.has(String(p.steamid || ""))
              );
              const sorted = sortPlayers(filtered);

              const binds = [];
              for (const p of sorted) {
                const key = mapSlotToKey(p.observer_slot);
                if (!key) continue;
                const nick = p.name_ingame || p.name || "";
                if (!nick) continue;
                binds.push(
                  `bind "${key}" "spec_player \"${escapeQuotes(nick)}\""`
                );
              }

              const header = [
                "// –ë–∏–Ω–¥—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–≥—Ä–æ–∫–æ–≤ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è SHUD)",
                'echo "Paste / exec these binds in console"',
              ];
              const content = [...header, ...binds].join("\n");
              bindsOutput.value = content;
            }

            if (refreshBindsBtn) {
              refreshBindsBtn.addEventListener("click", () => {
                renderSpecBinds();
              });
            }

            if (copyBindsBtn && bindsOutput) {
              copyBindsBtn.addEventListener("click", async () => {
                try {
                  await navigator.clipboard.writeText(bindsOutput.value);
                } catch (_) {
                  bindsOutput.select();
                  document.execCommand("copy");
                }
              });
            }

            const steamid1Input = document.getElementById("steamid1");
            const steamid2Input = document.getElementById("steamid2");
            if (steamid1Input)
              steamid1Input.addEventListener("change", renderSpecBinds);
            if (steamid2Input)
              steamid2Input.addEventListener("change", renderSpecBinds);

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–æ–∫–∞–∑ –±–∏–Ω–¥–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            renderSpecBinds();
          });
        </script>
        <!-- –ö–æ–Ω–µ—Ü —Ñ–æ—Ä–º—ã -->
        <!-- –°–µ–∫—Ü–∏—è –º–∞—Ç—á–∞ -->
        <section id="match-section" class="content-section active">
          <h2 data-i18n="matchSection">–°–æ–∑–¥–∞—Ç—å –ú–∞—Ç—á</h2>
          <div class="match-creator">
            <form id="createMatchForm">
              <div class="form-group">
                <label for="team1Select" data-i18n="team1">–ö–æ–º–∞–Ω–¥–∞ 1</label>
                <select id="team1Select" required>
                  <option value="" data-i18n="selectTeam">
                    –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É 1
                  </option>
                </select>
              </div>

              <div class="form-group">
                <label for="team2Select" data-i18n="team2">–ö–æ–º–∞–Ω–¥–∞ 2</label>
                <select id="team2Select" required>
                  <option value="" data-i18n="selectTeam">
                    –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É 2
                  </option>
                </select>
              </div>

              <button type="submit" class="save-btn" data-i18n="createMatch">
                –°–æ–∑–¥–∞—Ç—å –º–∞—Ç—á
              </button>
            </form>
          </div>
          <!-- –î–æ–±–∞–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π -->
          <div class="matches-list">
            <h3 data-i18n="currentMatches">–¢–µ–∫—É—â–∏–µ –º–∞—Ç—á–∏</h3>

            <div class="matches-container" id="matches-list">
              <!-- –ú–∞—Ç—á–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
            </div>
          </div>
          <div id="editMatchModal" class="modal">
            <div class="modal-content">
              <span data-i18n="editMatch">–†–µ–¥–∞–∫—Ç–æ—Ä –º–∞—Ç—á–∞</span>
              <form id="editMatchForm">
                <div class="team-container-edit">
                  <div class="form-group">
                    <label id="editTeam1Label" for="editTeam1" data-i18n="team1"
                      >–ö–æ–º–∞–Ω–¥–∞ 1:</label
                    >
                    <select name="team1" id="editTeam1" required>
                      <option value="" data-i18n="selectTeam">
                        –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É
                      </option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label id="editTeam2Label" for="editTeam2" data-i18n="team2"
                      >–ö–æ–º–∞–Ω–¥–∞ 2:</label
                    >
                    <select name="team2" id="editTeam2" required>
                      <option value="" data-i18n="selectTeam">
                        –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É
                      </option>
                    </select>
                  </div>
                  <button type="button" id="editSwapTeamsBtn">
                    <i class="fas fa-exchange-alt"></i>
                  </button>
                </div>
                <div class="team-container-edit2">
                  <div class="form-group">
                    <label
                      id="editFormatLabel"
                      for="editFormat"
                      data-i18n="format"
                      >–§–æ—Ä–º–∞—Ç:</label
                    >
                    <select name="format" id="editFormat" required>
                      <option value="bo1">BO1</option>
                      <option value="bo2">BO2</option>
                      <option value="bo3">BO3</option>
                      <option value="bo5">BO5</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="editMatchTime">–í—Ä–µ–º—è –º–∞—Ç—á–∞</label>
                    <input
                      type="text"
                      id="editMatchTime"
                      name="matchTime"
                      placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä, 18:00 –∏–ª–∏ 2024-08-05 18:00"
                    />
                  </div>
                </div>
                <div id="maps-save-btn" class="maps-save-btn">
                  <button data-i18n="save" type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
              </form>
            </div>
          </div>
        </section>
        <!-- –°–µ–∫—Ü–∏—è –∫–æ–º–∞–Ω–¥ -->
        <!-- –í —Å–µ–∫—Ü–∏–∏ teams-section -->

        <div id="teams-section" class="content-section">
          <h2 data-i18n="teamManagement">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–∞–º–∏</h2>
          <div class="form-container">
            <form id="team-form" enctype="multipart/form-data">
              <input
                data-i18n="teamName"
                type="text"
                name="name"
                placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã"
                required
              />
              <input
                data-i18n="teamShortName"
                type="text"
                name="short_name"
                placeholder="–ö–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã"
                maxlength="10"
              />
              <div class="team-region-with-flag">
                <span class="region-flag">
                  <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Ñ–ª–∞–≥ -->
                </span>
                <select id="team-region" name="region" class="region-select">
                  <option value="" data-i18n="selectRegion">
                    –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω
                  </option>
                  <option value="russia" data-flag="üá∑üá∫">üá∑üá∫ –†–æ—Å—Å–∏—è</option>
                  <option value="belarus" data-flag="üáßüáæ">üáßüáæ –ë–µ–ª–∞—Ä—É—Å—å</option>
                  <option value="kazakhstan" data-flag="üá∞üáø">
                    üá∞üáø –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω
                  </option>
                  <option value="europe" data-flag="üá™üá∫">üá™üá∫ –ï–≤—Ä–æ–ø–∞</option>
                  <option value="usa" data-flag="üá∫üá∏">üá∫üá∏ –°–®–ê</option>
                  <option value="canada" data-flag="üá®üá¶">üá®üá¶ –ö–∞–Ω–∞–¥–∞</option>
                  <option value="china" data-flag="üá®üá≥">üá®üá≥ –ö–∏—Ç–∞–π</option>
                  <option value="brazil" data-flag="üáßüá∑">üáßüá∑ –ë—Ä–∞–∑–∏–ª–∏—è</option>
                  <option value="ukraine" data-flag="üá∫üá¶">üá∫üá¶ –£–∫—Ä–∞–∏–Ω–∞</option>
                  <option value="other" data-flag="üåé">üåé –î—Ä—É–≥–æ–π —Ä–µ–≥–∏–æ–Ω</option>
                </select>
              </div>
              <div class="file-input-container" id="logo-input-container">
                <input
                  id="team-logo"
                  type="file"
                  name="logo"
                  accept="image/*"
                />
                <label
                  id="team-logo-label"
                  for="team-logo"
                  data-i18n="uploadTeamLogo"
                  >–ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø</label
                >
                <div id="team-logo-filename" class="file-name-note"></div>
              </div>
              <button data-i18n="addTeam" type="submit" id="add-team-btn">
                –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É
              </button>
            </form>
          </div>
          <div class="section-header"></div>
          <div class="teams-container" id="teams-list">
            <!-- –ö–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
          </div>
        </div>
        <!-- –°–µ–∫—Ü–∏—è –∏–≥—Ä–æ–∫–æ–≤ -->
        <section id="players-section" class="content-section">
          <h2 data-i18n="playerManagement">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏</h2>
          <form id="player-form">
            <input
              data-i18n="playerNickname"
              type="text"
              name="nickname"
              placeholder="–ù–∏–∫–Ω–µ–π–º"
              required
            />
            <input
              data-i18n="playerRealName"
              type="text"
              name="realName"
              placeholder="–†–µ–∞–ª—å–Ω–æ–µ –∏–º—è"
            />
            <input
              data-i18n="playerSteam64"
              type="text"
              name="steam64"
              placeholder="Steam64 ID"
              required
            />
            <select name="teamId">
              <option value="" data-i18n="selectTeam">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>
            </select>
            <div class="file-input-container" id="avatar-input-container">
              <input
                id="player-avatar"
                type="file"
                name="avatar"
                accept="image/*"
              />
              <label
                id="player-avatar-label"
                for="player-avatar"
                data-i18n="selectPlayerAvatar"
                >–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä</label
              >
              <div id="player-avatar-filename" class="file-name-note"></div>
            </div>
            <button data-i18n="addPlayer" type="submit" id="add-player-btn">
              –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞
            </button>
          </form>

          <div id="players-list" class="players-container"></div>
        </section>

        <!-- –í index.html, —Å–µ–∫—Ü–∏—è —Å–∫–æ—Ä–±–æ—Ä–¥–∞ -->
        <section id="scoreboard-section" class="content-section">
          <h2 data-i18n="scoreboardSection">–°–∫–æ—Ä–±–æ—Ä–¥</h2>
          <div class="scoreboard">
            <div class="team-scores"></div>
            <div class="player-stats-table">
              <!-- –¢–∞–±–ª–∏—Ü–∞ –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
          </div>
        </section>

        <!-- –°–µ–∫—Ü–∏—è HUD'–æ–≤ -->
        <section id="huds-section" class="content-section">
          <h2 data-i18n="hudsSection">–î–æ—Å—Ç—É–ø–Ω—ã–µ HUD'—ã</h2>
          <div id="huds-list" class="huds-grid"></div>
          <!-- –ú–æ–¥–∞–ª –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–≤–µ—Ç–æ–≤ HUD -->
          <div id="hud-colors-modal" class="modal" style="display: none">
            <div class="modal-content" style="max-width: 1200px; width: 95%">
              <div
                style="
                  display: flex;
                  align-items: center;
                  justify-content: space-between;
                "
              >
                <h3 style="margin: 0">
                  –¶–≤–µ—Ç–∞ HUD: <span id="hud-colors-title"></span>
                </h3>
                <button id="hud-colors-close" class="btn btn-secondary">
                  √ó
                </button>
              </div>
              <div
                id="hud-colors-form"
                style="
                  margin-top: 12px;
                  max-height: 60vh;
                  overflow-y: auto;
                  overflow-x: hidden;
                  padding-right: 8px;
                "
              ></div>
              <div style="display: flex; gap: 8px; margin-top: 12px">
                <button id="hud-colors-save" class="btn btn-primary">
                  –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
                <button id="hud-colors-reset" class="btn btn-warning">
                  –°–±—Ä–æ—Å–∏—Ç—å –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—É
                </button>
                <button id="hud-colors-cancel" class="btn btn-secondary">
                  –û—Ç–º–µ–Ω–∞
                </button>
              </div>
            </div>
          </div>
        </section>
        <section id="cs2-section" class="content-section">
          <div class="container mt-5">
            <div class="row">
              <div class="col-md-12">
                <div class="card-cfg">
                  <div class="card-header bg-primary text-white">
                    <h5
                      id="cs2-integration-title"
                      class="mb-0"
                      data-i18n="cs2Integration"
                    >
                      CFG –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
                    </h5>
                  </div>
                  <div class="card-body">
                    <div class="cfg-block" id="block-cs2">
                      <h5 class="mb-2">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è CS2</h5>
                      <div class="row mb-4">
                        <div class="col-md-12">
                          <h6
                            id="cs2-configs-status"
                            data-i18n="cs2ConfigsStatus"
                          >
                            –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ñ–∏–≥–æ–≤
                          </h6>
                          <div class="status-list mb-2">
                            <p
                              id="cs2-gsi-status"
                              class="text-success mb-1"
                              data-i18n="cs2GsiInstalled"
                            >
                              <span class="status-dot green"></span>GSI –∫–æ–Ω—Ñ–∏–≥
                              —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                            </p>
                            <p
                              id="cs2-observer-status"
                              class="text-success mb-1"
                              data-i18n="cs2ObserverInstalled"
                            >
                              <span class="status-dot green"></span>Observer
                              –∫–æ–Ω—Ñ–∏–≥ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                            </p>
                            <p
                              id="cs2-observer_tools-status"
                              class="text-success mb-1"
                            >
                              <span class="status-dot green"></span
                              >observer_cs2_tools_killfeed —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                            </p>
                            <p
                              id="cs2-observer2-status"
                              class="text-danger mb-1"
                              data-i18n="cs2Observer2NotInstalled"
                            >
                              <span class="status-dot red"></span
                              >Observer_map_cs2_on –∫–æ–Ω—Ñ–∏–≥ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                            </p>
                            <p
                              id="cs2-observer_off-status"
                              class="text-success mb-1"
                              data-i18n="cs2Observer_offInstalled"
                            >
                              <span class="status-dot green"></span>Observer_off
                              –∫–æ–Ω—Ñ–∏–≥ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                            </p>
                            <p
                              id="cs2-observer_hlae_kill-status"
                              class="text-success mb-1"
                            >
                              <span class="status-dot green"></span>
                              observer_HLAE_kill.cfg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                            </p>
                          </div>
                        </div>
                      </div>
                      <div class="row mb-3">
                        <div class="col-md-12">
                          <input
                            type="text"
                            id="cs2-custom-path"
                            class="form-control"
                            placeholder="–ü—É—Ç—å –∫ CS2 (–±–µ–∑ game/csgo/cfg)"
                          />
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-12">
                          <div class="button-row">
                            <button
                              id="check-cs2-path"
                              class="btn btn-secondary"
                              data-i18n="cs2CheckPath"
                            >
                              –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
                            </button>
                            <button
                              id="install-cs2-configs"
                              class="btn btn-primary"
                              data-i18n="cs2InstallConfigs"
                            >
                              –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏ CS2
                            </button>
                            <button
                              id="remove-cs2-configs"
                              class="btn btn-danger"
                              data-i18n="cs2RemoveConfigs"
                            >
                              –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏ CS2
                            </button>
                          </div>
                        </div>
                      </div>
                      <div class="row mt-3">
                        <div class="col-md-12">
                          <button
                            id="launch-cs2-observer"
                            class="btn btn-success btn-block"
                          >
                            –ó–∞–ø—É—Å—Ç–∏—Ç—å CS2 —Å exec observer
                          </button>
                          <button
                            id="launch-hlae"
                            class="btn btn-warning btn-block mt-2"
                          >
                            –ó–∞–ø—É—Å—Ç–∏—Ç—å HLAE + CS2 —Å exec observer_HLAE_kill
                          </button>
                          <!-- –ö–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞ -->
                          <button
                            id="launch-cs2-hlae-insecure"
                            class="btn btn-info btn-block mt-2"
                          >
                            –ó–∞–ø—É—Å—Ç–∏—Ç—å CS2 + Tools + HLAE exec
                            observer_cs2_tools_killfeed
                          </button>
                        </div>
                      </div>
                    </div>

                    <!-- Dota 2 CFG –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è -->
                    <div class="cfg-block mt-4" id="block-dota2">
                      <h5 class="mb-2">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Dota 2</h5>
                      <div class="row">
                        <div class="col-md-12">
                          <h6>–°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ñ–∏–≥–æ–≤</h6>

                          <div id="dota2-cfg-details" style="display: none">
                            <p id="dota2-cfg-file-status">
                              ? gamestate_integration_fhud_dota2.cfg —Å—Ç–∞—Ç—É—Å
                              –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω
                            </p>
                          </div>
                        </div>
                      </div>
                      <div class="row mb-3">
                        <div class="col-md-12">
                          <input
                            type="text"
                            id="dota2-custom-path"
                            class="form-control"
                            placeholder="–ü—É—Ç—å –∫ Dota 2 (–±–µ–∑ game/dota/cfg)"
                          />
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-12">
                          <div class="button-row mb-2" role="group">
                            <button id="check-dota2-cfg" class="btn btn-info">
                              –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É
                            </button>
                            <button
                              id="install-dota2-cfg"
                              class="btn btn-success"
                            >
                              –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å CFG
                            </button>
                            <button
                              id="remove-dota2-cfg"
                              class="btn btn-danger"
                            >
                              –£–¥–∞–ª–∏—Ç—å CFG
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- –†–µ–¥–∞–∫—Ç–æ—Ä cfg -->
                    <div class="cfg-block mt-4" id="block-cfg-editor">
                      <h5 class="mb-2">–†–∞–±–æ—Ç–∞ —Å cfg —Ñ–∞–π–ª–∞–º–∏</h5>
                      <div class="col-md-12">
                        <div class="form-group mb-2">
                          <label for="cfg-file-select">–§–∞–π–ª:</label>
                          <select
                            id="cfg-file-select"
                            class="form-control"
                          ></select>
                        </div>
                        <div class="form-group mb-2">
                          <label for="cfg-editor">–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:</label>
                          <textarea
                            id="cfg-editor"
                            class="form-control"
                            rows="12"
                            style="font-family: monospace"
                          ></textarea>
                        </div>
                        <div class="btn-group" role="group">
                          <button id="cfg-load" class="btn btn-secondary">
                            –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
                          </button>
                          <button id="cfg-save" class="btn btn-primary">
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <!-- –°–µ–∫—Ü–∏—è –ö–∞–º–µ—Ä—ã -->
        <section id="cameras-section" class="content-section">
          <h2>–°–µ–ª–µ–∫—Ç–æ—Ä –∫–∞–º–µ—Ä—ã</h2>
          <div id="camera-players-list">
            <h3>–ö–æ–º–∞–Ω–¥–∞ CT</h3>
            <div class="camera-team-list">
              <div class="camera-player-row">
                <span class="camera-player-name">MisTraLook</span>
                <input ... />
                <button ...>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              </div>
              <!-- ... -->
            </div>
            <h3>–ö–æ–º–∞–Ω–¥–∞ T</h3>
            <div class="camera-team-list">
              <div class="camera-player-row">
                <span class="camera-player-name">dS</span>
                <input ... />
                <button ...>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              </div>
              <!-- ... -->
            </div>
          </div>
          <button id="refresh-cameras-btn">–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤</button>
        </section>
      </main>
    </div>

    <script>
      // –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ –∏ –∞–≤–∞—Ç–∞—Ä–∫–∏
      document.addEventListener("DOMContentLoaded", function () {
        function initFileInputs() {
          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø–∞ –∫–æ–º–∞–Ω–¥—ã
          initFileInput(
            "team-logo",
            "logo-input-container",
            "team-logo-label",
            "–ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø",
            "team-logo-filename"
          );

          // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∫–∏ –∏–≥—Ä–æ–∫–∞
          initFileInput(
            "player-avatar",
            "avatar-input-container",
            "player-avatar-label",
            "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä",
            "player-avatar-filename"
          );
        }

        function initFileInput(
          inputId,
          containerId,
          labelId,
          defaultText,
          fileNameDisplayId
        ) {
          const input = document.getElementById(inputId);
          const container = document.getElementById(containerId);
          const label = document.getElementById(labelId);
          const fileNameDisplay = fileNameDisplayId
            ? document.getElementById(fileNameDisplayId)
            : null;

          if (input && container && label) {
            input.addEventListener("change", function () {
              if (this.files && this.files.length > 0) {
                const fileName = this.files[0].name;
                if (fileNameDisplay) fileNameDisplay.textContent = fileName;
                label.textContent = defaultText;
                container.classList.add("has-file");
                label.style.backgroundColor = "#007bff";
                label.style.color = "white";
              } else {
                label.textContent = defaultText;
                container.classList.remove("has-file");
                label.style.backgroundColor = "";
                label.style.color = "";
                if (fileNameDisplay) fileNameDisplay.textContent = "";
              }
            });
          }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ —Ñ–æ—Ä–º—ã —Ñ–∞–π–ª–∞
        function resetFileInput(
          inputId,
          containerId,
          labelId,
          defaultText,
          fileNameDisplayId
        ) {
          const input = document.getElementById(inputId);
          const container = document.getElementById(containerId);
          const label = document.getElementById(labelId);
          const fileNameDisplay = fileNameDisplayId
            ? document.getElementById(fileNameDisplayId)
            : null;

          if (input) {
            input.value = "";
          }
          if (container) {
            container.classList.remove("has-file");
          }
          if (label) {
            label.textContent = defaultText;
            label.style.backgroundColor = "";
            label.style.color = "";
          }
          if (fileNameDisplay) fileNameDisplay.textContent = "";
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
        function changeButtonToEdit(buttonId, newText) {
          const button = document.getElementById(buttonId);
          if (button) {
            button.textContent = newText;
            button.style.backgroundColor = "#007bff";
            button.style.borderColor = "#007bff";
          }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–Ω–æ–ø–∫–∏ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
        function resetButtonToAdd(buttonId, originalText) {
          const button = document.getElementById(buttonId);
          if (button) {
            button.textContent = originalText;
            button.style.backgroundColor = "";
            button.style.borderColor = "";
          }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        initFileInputs();

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã
        const teamForm = document.getElementById("team-form");
        if (teamForm) {
          teamForm.addEventListener("submit", function (e) {
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã —Ñ–∞–π–ª–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
            setTimeout(() => {
              resetFileInput(
                "team-logo",
                "logo-input-container",
                "team-logo-label",
                "–ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø",
                "team-logo-filename"
              );
              resetButtonToAdd("add-team-btn", "–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É");
            }, 1000);
          });
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞
        const playerForm = document.getElementById("player-form");
        if (playerForm) {
          playerForm.addEventListener("submit", function (e) {
            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã —Ñ–∞–π–ª–∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
            setTimeout(() => {
              resetFileInput(
                "player-avatar",
                "avatar-input-container",
                "player-avatar-label",
                "–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä",
                "player-avatar-filename"
              );
              resetButtonToAdd("add-player-btn", "–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞");
            }, 1000);
          });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
        const navButtons = document.querySelectorAll(".nav-button");
        if (navButtons) {
          navButtons.forEach((button) => {
            button.addEventListener("click", function () {
              // –î–∞–µ–º DOM –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–∫–∏
              setTimeout(initFileInputs, 200);
            });
          });
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ main.js
        window.changeButtonToEdit = changeButtonToEdit;
        window.resetButtonToAdd = resetButtonToAdd;

        // –ó–∞–ø—É—Å–∫ CS2 —á–µ—Ä–µ–∑ Steam protocol —Å +exec observer
        const launchBtn = document.getElementById("launch-cs2-observer");
        if (launchBtn) {
          launchBtn.addEventListener("click", async function () {
            try {
              const resp = await fetch("/api/launch-cs2-exec", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ configName: "observer" }),
              });
              const data = await resp.json().catch(() => ({}));
              if (resp.ok) {
                alert("CS2 –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å exec observer");
              } else {
                alert(`–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞: ${data.error || "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}`);
              }
            } catch (e) {
              alert("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É –∑–∞–ø—É—Å–∫–∞ CS2");
            }
          });
        }

        // –ó–∞–ø—É—Å–∫ HLAE
        const launchHlaeBtn = document.getElementById("launch-hlae");
        if (launchHlaeBtn) {
          launchHlaeBtn.addEventListener("click", async function () {
            try {
              const resp = await fetch("/api/launch-hlae", { method: "POST" });
              const data = await resp.json().catch(() => ({}));
              if (resp.ok) {
                alert("HLAE –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è");
              } else {
                alert(`–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ HLAE: ${data.error || "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}`);
              }
            } catch (e) {
              alert("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É –∑–∞–ø—É—Å–∫–∞ HLAE");
            }
          });
        }

        // –ó–∞–ø—É—Å–∫ CS2 HLAE
        const launchCs2HlaeInsecureBtn = document.getElementById(
          "launch-cs2-hlae-insecure"
        );
        if (launchCs2HlaeInsecureBtn) {
          launchCs2HlaeInsecureBtn.addEventListener("click", async function () {
            const customPathInput = document.getElementById("cs2-custom-path");
            const cs2Path =
              (customPathInput && customPathInput.value.trim()) || undefined;
            // –ü—É—Ç—å –∫ interop (–µ—Å–ª–∏ –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ)
            const interopPath =
              "H:/project/public/afx-cefhud-interop/afx-cefhud-interop.exe";
            try {
              const resp = await fetch("/api/launch-cs2-hlae-insecure", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ cs2Path, interopPath }),
              });
              const data = await resp.json().catch(() => ({}));
              if (resp.ok) {
                alert("CS2 + Tools + HLAE exec –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è");
              } else {
                alert(`–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞: ${data.error || "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}`);
              }
            } catch (e) {
              alert("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ HLAE");
            }
          });
        }

        // –†–µ–¥–∞–∫—Ç–æ—Ä cfg
        const cfgSelect = document.getElementById("cfg-file-select");
        const cfgEditor = document.getElementById("cfg-editor");
        const cfgLoadBtn = document.getElementById("cfg-load");
        const cfgSaveBtn = document.getElementById("cfg-save");

        async function loadCfgList() {
          try {
            const resp = await fetch("/api/cs2-config/list");
            const data = await resp.json();
            if (resp.ok && data.success) {
              cfgSelect.innerHTML = "";
              for (const f of data.files) {
                const opt = document.createElement("option");
                opt.value = f;
                opt.textContent = f;
                cfgSelect.appendChild(opt);
              }
            } else {
              alert(`–û—à–∏–±–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤: ${data.error || "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}`);
            }
          } catch (e) {
            alert("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤");
          }
        }

        async function loadCfg() {
          const name = cfgSelect.value;
          const url = new URL("/api/cs2-config", window.location.origin);
          url.searchParams.set("name", name);
          try {
            const resp = await fetch(url.toString());
            const data = await resp.json();
            if (resp.ok && data.success) {
              cfgEditor.value = data.content || "";
            } else {
              alert(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${data.error || "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}`);
            }
          } catch (e) {
            alert("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞");
          }
        }

        async function saveCfg() {
          const name = cfgSelect.value;
          const body = { name, content: cfgEditor.value };
          try {
            const resp = await fetch("/api/cs2-config", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(body),
            });
            const data = await resp.json().catch(() => ({}));
            if (resp.ok && data.success) {
              alert("–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—ë–Ω");
            } else {
              alert(`–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ${data.error || "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}`);
            }
          } catch (e) {
            alert("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞");
          }
        }

        if (cfgLoadBtn) cfgLoadBtn.addEventListener("click", loadCfg);
        if (cfgSaveBtn) cfgSaveBtn.addEventListener("click", saveCfg);
        if (cfgSelect) cfgSelect.addEventListener("change", loadCfg);
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –ø–æ–¥—Ç—è–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª
        loadCfgList().then(() => {
          if (cfgSelect && cfgSelect.options.length > 0) {
            loadCfg();
          }
        });

        // Dota 2 CFG Integration
        const checkDota2CfgBtn = document.getElementById("check-dota2-cfg");
        const installDota2CfgBtn = document.getElementById("install-dota2-cfg");
        // –£–±—Ä–∞–ª–∏ –æ–±—â—É—é —Å—Ç—Ä–æ–∫—É —Å—Ç–∞—Ç—É—Å–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –¥–µ—Ç–∞–ª—å–Ω—É—é –ª–∞–º–ø–æ—á–∫—É
        const dota2CfgInfo = document.getElementById("dota2-cfg-info");
        const dota2Path = document.getElementById("dota2-path");
        const dota2CfgPath = document.getElementById("dota2-cfg-path");

        async function checkDota2CfgInstallation() {
          try {
            const customDotaPathInput =
              document.getElementById("dota2-custom-path");
            let url = "/api/dota2-cfg-check";
            if (customDotaPathInput && customDotaPathInput.value) {
              url += `?path=${encodeURIComponent(customDotaPathInput.value)}`;
            }
            const response = await fetch(url);
            const data = await response.json();

            // –û–±—â—É—é —Å—Ç—Ä–æ–∫—É —Å—Ç–∞—Ç—É—Å–∞ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º; –Ω–∏–∂–µ –≤—ã—Å—Ç–∞–≤–ª—è–µ–º –ª–∞–º–ø–æ—á–∫—É –≤ –¥–µ—Ç–∞–ª—è—Ö

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
            const detailsDiv = document.getElementById("dota2-cfg-details");
            const fileStatus = document.getElementById("dota2-cfg-file-status");

            if (detailsDiv) {
              detailsDiv.style.display = "block";

              if (fileStatus) {
                if (data.cfgExists) {
                  fileStatus.innerHTML =
                    '<span class="status-dot green"></span>gamestate_integration_fhud_dota2.cfg —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';
                } else {
                  fileStatus.innerHTML =
                    '<span class="status-dot red"></span>gamestate_integration_fhud_d–æ—Ç–∞2.cfg –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';
                }
              }
            }

            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—É—Ç—è—Ö —Å–∫—Ä—ã—Ç–∞ –ø–æ –¢–ó; –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º
          } catch (error) {
            console.error("Error checking Dota 2 CFG:", error);
            const detailsDiv = document.getElementById("dota2-cfg-details");
            const fileStatus = document.getElementById("dota2-cfg-file-status");
            if (detailsDiv) detailsDiv.style.display = "block";
            if (fileStatus)
              fileStatus.innerHTML =
                '<span class="status-dot red"></span>gamestate_integration_fhud_dota2.cfg –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';
          }
        }

        async function installDota2Cfg() {
          try {
            const customDotaPathInput =
              document.getElementById("dota2-custom-path");
            const response = await fetch("/api/dota2-cfg-install", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ path: customDotaPathInput?.value || "" }),
            });
            await response.json();
          } catch (error) {
            console.error("Error installing Dota 2 CFG:", error);
          } finally {
            setTimeout(() => {
              checkDota2CfgInstallation();
            }, 500);
          }
        }

        async function removeDota2Cfg() {
          if (!confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å CFG —Ñ–∞–π–ª Dota 2?")) {
            return;
          }

          try {
            const customDotaPathInput =
              document.getElementById("dota2-custom-path");
            let url = "/api/dota2-cfg-remove";
            if (customDotaPathInput && customDotaPathInput.value) {
              url += `?path=${encodeURIComponent(customDotaPathInput.value)}`;
            }
            await (await fetch(url)).json();
          } catch (error) {
            console.error("Error removing Dota 2 CFG:", error);
          } finally {
            setTimeout(() => {
              checkDota2CfgInstallation();
            }, 500);
          }
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        if (checkDota2CfgBtn) {
          checkDota2CfgBtn.addEventListener("click", async function () {
            try {
              await checkDota2CfgInstallation();
            } finally {
            }
          });
        }
        if (installDota2CfgBtn) {
          installDota2CfgBtn.addEventListener("click", installDota2Cfg);
        }

        const removeDota2CfgBtn = document.getElementById("remove-dota2-cfg");
        if (removeDota2CfgBtn) {
          removeDota2CfgBtn.addEventListener("click", removeDota2Cfg);
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        checkDota2CfgInstallation();
      });
    </script>

    <!-- Font Awesome –¥–ª—è –∏–∫–æ–Ω–æ–∫ -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="/js/gsiManager.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/overlayManager.js"></script>
    <script src="/js/localization.js"></script>

    <script src="/js/version-check.js"></script>
  </body>
</html>
